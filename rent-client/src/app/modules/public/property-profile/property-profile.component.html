<div class="profile-container" *ngIf="!loading && apartment">
  <div class="media-section" *ngIf="apartment.images?.length">
    <img [src]="apartment.images[0]" class="hero-image">
    <div class="image-gallery" *ngIf="apartment.images.length > 1">
      <img *ngFor="let img of apartment.images.slice(1)" [src]="img" class="gallery-thumb">
    </div>
  </div>

  <mat-card class="info-card">
    <mat-card-header>
      <mat-card-title>{{apartment.city}} - {{apartment.address}}</mat-card-title>
      <mat-card-subtitle>{{apartment.rooms}} חדרים | קומה {{apartment.floor}} | {{apartment.sqm}} מ"ר</mat-card-subtitle>
      <div class="price-tag">{{apartment.price | number}} ₪</div>
    </mat-card-header>

    <mat-card-content>
      <p class="description">{{apartment.description}}</p>
      
      <mat-divider></mat-divider>
      
      <div class="features-grid">
        <div class="feature" *ngIf="apartment.balcony">
          <mat-icon>balcony</mat-icon> <span>מרפסת</span>
        </div>
        <div class="feature" *ngIf="apartment.parking">
          <mat-icon>local_parking</mat-icon> <span>חניה</span>
        </div>
        <div class="feature" *ngIf="apartment.elevator">
          <mat-icon>elevator</mat-icon> <span>מעלית</span>
        </div>
        <div class="feature" *ngIf="apartment.mamad">
          <mat-icon>security</mat-icon> <span>ממ"ד</span>
        </div>
      </div>

      <mat-divider></mat-divider>

      <div class="extra-info">
        <p><strong>תאריך כניסה:</strong> {{apartment.entryDate ? (apartment.entryDate | date:'dd/MM/yyyy') : 'מיידי'}}</p>
        <p><strong>ארנונה:</strong> {{apartment.arnona}} ₪</p>
        <p><strong>ועד בית:</strong> {{apartment.vaadBayit}} ₪</p>
      </div>
    </mat-card-content>

    <mat-card-actions>
      <button mat-raised-button color="primary" (click)="openWaze()">
        <mat-icon>directions_car</mat-icon> ניווט לנכס
      </button>
      <a mat-raised-button color="accent" [href]="'https://t.me/dvir_rent_bot?start=' + apartment.id.split('-')[0]">
        <mat-icon>chat</mat-icon> תיאום סיור בבוט
      </a>
    </mat-card-actions>
  </mat-card>
</div>

<div class="loading-state" *ngIf="loading">
  <mat-spinner diameter="50"></mat-spinner>
</div>

<div class="error-state" *ngIf="error">
  <mat-icon>error_outline</mat-icon>
  <h2>הנכס לא נמצא או שהלינק לא תקין</h2>
  <button mat-button color="primary" routerLink="/">חזרה לדף הבית</button>
</div>
